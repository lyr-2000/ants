{"remainingRequest":"C:\\Users\\123\\Desktop\\大创\\reldomo\\ants\\src\\main\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\123\\Desktop\\大创\\reldomo\\ants\\src\\main\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\Users\\123\\Desktop\\大创\\reldomo\\ants\\src\\main\\src\\store\\modules\\chat.js","dependencies":[{"path":"C:\\Users\\123\\Desktop\\大创\\reldomo\\ants\\src\\main\\src\\store\\modules\\chat.js","mtime":1568695308516},{"path":"C:\\Users\\123\\Desktop\\大创\\reldomo\\ants\\src\\main\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\123\\Desktop\\大创\\reldomo\\ants\\src\\main\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\123\\Desktop\\大创\\reldomo\\ants\\src\\main\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["var namespaced = true;\nvar state = {\n  ws: \"\",\n  url: \"ws://127.0.0.1:8080/chat?\",\n  myId: '',\n  // 用户自己的id\n  userList: [{\n    contactor: 1,\n    imgSrc: require(\"../../assets/img/index/antsLogo.png\"),\n    contactorName: 'abc',\n    latestTime: '2019/8/10'\n  }, {\n    contactor: 2,\n    imgSrc: require(\"../../assets/img/index/antsLogo.png\"),\n    contactorName: '111',\n    latestTime: '2019/7/10'\n  }, {\n    contactor: 3,\n    imgSrc: require(\"../../assets/img/index/antsLogo.png\"),\n    contactorName: '222',\n    latestTime: '2019/6/20'\n  }, {\n    contactor: 4,\n    imgSrc: require(\"../../assets/img/index/antsLogo.png\"),\n    contactorName: '333',\n    latestTime: '2019/5/10'\n  }],\n  chooseUser: {\n    contactor: 1,\n    imgSrc: require(\"../../assets/img/index/antsLogo.png\"),\n    contactorName: 'abc',\n    latestTime: '2019/8/10'\n  },\n  // 聊天框中的信息\n  // identify false为对方消息 true为自己的消息\n  // type 1：文本信息   2：文件\n  newsList: [{\n    identify: false,\n    content: '如果没记错的话应该是在体育中心总店买的吧,才用了几次',\n    type: 1\n  }, {\n    identify: true,\n    content: '请问怎么议价，能不能再便宜一点呢~',\n    type: 1\n  }, {\n    identify: false,\n    content: '不可以',\n    type: 1\n  }, {\n    identify: false,\n    content: '好吧，可以再少一点。',\n    type: 1\n  }, {\n    identify: false,\n    content: require(\"../../assets/img/index/antsLogo.png\"),\n    type: 2\n  }]\n};\nvar getters = {\n  getUserList: function getUserList(state) {\n    return state.userList;\n  },\n  getChooseUser: function getChooseUser(state) {\n    return state.chooseUser;\n  },\n  getNewsList: function getNewsList(state) {\n    return state.newsList;\n  }\n};\nvar mutations = {\n  chooseChange: function chooseChange(state, user) {\n    state.chooseUser = user;\n  },\n  // 将信息推送到聊天记录框中\n  pushMsg: function pushMsg(state, data) {\n    state.newsList.push(data);\n  },\n  // 修改联系人列表\n  changeUserList: function changeUserList(state, contactorlist) {\n    state.userList = contactorlist;\n  }\n};\nvar actions = {\n  // 选择另一个用户\n  chooseChange: function chooseChange(_ref, user) {\n    var commit = _ref.commit,\n        state = _ref.state;\n    commit(\"chooseChange\", user);\n  },\n  // websocket连接\n  socketInit: function socketInit(_ref2, _ref3) {\n    var state = _ref2.state,\n        dispatch = _ref2.dispatch;\n    var id = _ref3.id,\n        business = _ref3.business;\n    var url = \"\";\n    state.myId = id;\n\n    if (!business) {\n      url = \"\".concat(state.url, \"id=\").concat(id, \"&business=\").concat(business);\n    } else {\n      url = \"\".concat(state.url, \"id=\").concat(id);\n    }\n\n    if ('WebSocket' in window) {\n      state.ws = new WebSocket(url);\n      dispatch(\"onMessage\");\n    } else if ('MozWebSocket' in window) {\n      state.ws = new MozWebSocket(url);\n      dispatch(\"onMessage\");\n    } else {\n      alert('WebSocket is not supported by this browser.');\n      return;\n    }\n  },\n  // 连接后获取数据\n  onMessage: function onMessage(_ref4) {\n    var state = _ref4.state,\n        commit = _ref4.commit;\n    console.log('state: ', state);\n\n    state.ws.onmessage = function (event) {\n      console.log(\"event:\", event);\n      var data = JSON.parse(event.data);\n\n      if (data.type == 0) {\n        // 用户下线\n        console.log(\"用户下线\");\n      } else if (data.type == 1) {\n        console.log('event.data: ', data); // 接收文本信息\n\n        var identify = false;\n\n        if (data.id == state.myId) {\n          identify = true;\n        }\n\n        commit(\"pushMsg\", {\n          content: data.msg,\n          identify: identify,\n          type: 1\n        });\n      } else if (data.type == 2) {\n        // 接收文件\n        console.log('data: ', data);\n        var _identify = false;\n\n        if (data.id == state.myId) {\n          _identify = true;\n        }\n\n        commit(\"pushMsg\", {\n          content: data.msg,\n          identify: _identify,\n          type: 2\n        });\n      } else if (data.type == 4) {// 接收历史消息\n      } else if (data.type == 5) {\n        console.log('data: ', data);\n        commit('changeUserList', data.contactorlist);\n      }\n    };\n  },\n  // 连接后发送数据\n  onSend: function onSend(_ref5, _ref6) {\n    var state = _ref5.state;\n    var data = _ref6.data,\n        file = _ref6.file;\n\n    // 发送文本信息\n    if (data.type === 1) {\n      data = JSON.stringify(data);\n      state.wx.send(data);\n    } // 发送文件\n\n\n    if (data.type === 2) {\n      var reader = new FileReader();\n      reader.readAsArrayBuffer(file);\n\n      reader.onload = function (e) {\n        var blob = e.target.result;\n        var fileFinish = {\n          type: 3,\n          id: data.id,\n          business: data.business\n        }; // 提示后端文件发送完毕\n\n        blob = JSON.stringify(blob);\n        fileFinish = JSON.stringify(fileFinish);\n        state.wx.send(blob);\n        state.wx.send(fileFinish);\n      };\n    }\n  }\n};\nexport default {\n  state: state,\n  getters: getters,\n  mutations: mutations,\n  actions: actions,\n  namespaced: namespaced\n};",{"version":3,"sources":["C:\\Users\\123\\Desktop\\大创\\reldomo\\ants\\src\\main\\src\\store\\modules\\chat.js"],"names":["namespaced","state","ws","url","myId","userList","contactor","imgSrc","require","contactorName","latestTime","chooseUser","newsList","identify","content","type","getters","getUserList","getChooseUser","getNewsList","mutations","chooseChange","user","pushMsg","data","push","changeUserList","contactorlist","actions","commit","socketInit","dispatch","id","business","window","WebSocket","MozWebSocket","alert","onMessage","console","log","onmessage","event","JSON","parse","msg","onSend","file","stringify","wx","send","reader","FileReader","readAsArrayBuffer","onload","e","blob","target","result","fileFinish"],"mappings":"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","sourcesContent":["const namespaced = true;\r\nconst state = {\r\n    ws: \"\",\r\n    url: \"ws://127.0.0.1:8080/chat?\",\r\n    myId: '', // 用户自己的id\r\n    userList: [{\r\n        contactor: 1,\r\n        imgSrc: require(\"../../assets/img/index/antsLogo.png\"),\r\n        contactorName: 'abc',\r\n        latestTime: '2019/8/10'\r\n    }, {\r\n        contactor: 2,\r\n        imgSrc: require(\"../../assets/img/index/antsLogo.png\"),\r\n        contactorName: '111',\r\n        latestTime: '2019/7/10'\r\n    }, {\r\n        contactor: 3,\r\n        imgSrc: require(\"../../assets/img/index/antsLogo.png\"),\r\n        contactorName: '222',\r\n        latestTime: '2019/6/20'\r\n    }, {\r\n        contactor: 4,\r\n        imgSrc: require(\"../../assets/img/index/antsLogo.png\"),\r\n        contactorName: '333',\r\n        latestTime: '2019/5/10'\r\n    }],\r\n    chooseUser: {\r\n        contactor: 1,\r\n        imgSrc: require(\"../../assets/img/index/antsLogo.png\"),\r\n        contactorName: 'abc',\r\n        latestTime: '2019/8/10'\r\n    },\r\n    // 聊天框中的信息\r\n    // identify false为对方消息 true为自己的消息\r\n    // type 1：文本信息   2：文件\r\n    newsList: [{\r\n        identify: false,\r\n        content: '如果没记错的话应该是在体育中心总店买的吧,才用了几次',\r\n        type: 1\r\n    }, {\r\n        identify: true,\r\n        content: '请问怎么议价，能不能再便宜一点呢~',\r\n        type: 1\r\n    }, {\r\n        identify: false,\r\n        content: '不可以',\r\n        type: 1\r\n    }, {\r\n        identify: false,\r\n        content: '好吧，可以再少一点。',\r\n        type: 1\r\n    }, {\r\n        identify: false,\r\n        content: require(\"../../assets/img/index/antsLogo.png\"),\r\n        type: 2\r\n    }, ]\r\n}\r\nconst getters = {\r\n    getUserList(state) {\r\n        return state.userList\r\n    },\r\n    getChooseUser(state) {\r\n        return state.chooseUser\r\n    },\r\n    getNewsList(state) {\r\n        return state.newsList\r\n    }\r\n}\r\nconst mutations = {\r\n    chooseChange(state, user) {\r\n        state.chooseUser = user;\r\n    },\r\n    // 将信息推送到聊天记录框中\r\n    pushMsg(state, data) {\r\n        state.newsList.push(data);\r\n    },\r\n    // 修改联系人列表\r\n    changeUserList(state, contactorlist) {\r\n        state.userList = contactorlist;\r\n    }\r\n}\r\n\r\nconst actions = {\r\n    // 选择另一个用户\r\n    chooseChange({ commit, state }, user) {\r\n        commit(\"chooseChange\", user)\r\n    },\r\n    // websocket连接\r\n    socketInit({ state, dispatch }, { id, business }) {\r\n        let url = \"\";\r\n        state.myId = id;\r\n        if (!business) {\r\n            url = `${state.url}id=${id}&business=${business}`;\r\n        } else {\r\n            url = `${state.url}id=${id}`;\r\n        }\r\n        if ('WebSocket' in window) {\r\n            state.ws = new WebSocket(url);\r\n            dispatch(\"onMessage\")\r\n        } else if ('MozWebSocket' in window) {\r\n            state.ws = new MozWebSocket(url);\r\n            dispatch(\"onMessage\")\r\n        } else {\r\n            alert('WebSocket is not supported by this browser.');\r\n            return;\r\n        }\r\n    },\r\n    // 连接后获取数据\r\n    onMessage({ state, commit }) {\r\n        console.log('state: ', state);\r\n        state.ws.onmessage = function(event) {\r\n            console.log(\"event:\", event);\r\n            let data = JSON.parse(event.data);\r\n            if (data.type == 0) {\r\n                // 用户下线\r\n                console.log(\"用户下线\")\r\n            } else if (data.type == 1) {\r\n                console.log('event.data: ', data);\r\n                // 接收文本信息\r\n                let identify = false;\r\n                if (data.id == state.myId) {\r\n                    identify = true;\r\n                }\r\n                commit(\"pushMsg\", { content: data.msg, identify: identify, type: 1 })\r\n            } else if (data.type == 2) {\r\n                // 接收文件\r\n                console.log('data: ', data);\r\n                let identify = false;\r\n                if (data.id == state.myId) {\r\n                    identify = true;\r\n                }\r\n                commit(\"pushMsg\", { content: data.msg, identify: identify, type: 2 })\r\n            } else if (data.type == 4) {\r\n                // 接收历史消息\r\n\r\n            } else if (data.type == 5) {\r\n                console.log('data: ', data);\r\n                commit('changeUserList', data.contactorlist)\r\n            }\r\n        }\r\n    },\r\n    // 连接后发送数据\r\n    onSend({ state }, { data, file }) {\r\n        // 发送文本信息\r\n        if (data.type === 1) {\r\n            data = JSON.stringify(data);\r\n            state.wx.send(data)\r\n        }\r\n        // 发送文件\r\n        if (data.type === 2) {\r\n            let reader = new FileReader();\r\n            reader.readAsArrayBuffer(file)\r\n            reader.onload = function(e) {\r\n                let blob = e.target.result\r\n                let fileFinish = {\r\n                    type: 3,\r\n                    id: data.id,\r\n                    business: data.business\r\n                };\r\n                // 提示后端文件发送完毕\r\n                blob = JSON.stringify(blob);\r\n                fileFinish = JSON.stringify(fileFinish);\r\n                state.wx.send(blob)\r\n                state.wx.send(fileFinish)\r\n            }\r\n        }\r\n    },\r\n}\r\n\r\nexport default { state, getters, mutations, actions, namespaced }"]}]}